import { parse } from '../src/ocr'

describe('Ocr', () => {
  it('parses_one_record_with_888888888', () => {
    expect(
      parse([
        ' _   _   _   _   _   _   _   _   _  ',
        '|_| |_| |_| |_| |_| |_| |_| |_| |_| ',
        '|_| |_| |_| |_| |_| |_| |_| |_| |_| ',
        '                                    ',
      ])
    ).toEqual(['888888888 ERR'])
  })

  it('parses_two_records_with_888888888', () => {
    expect(
      parse([
        ' _   _   _   _   _   _   _   _   _  ',
        '|_| |_| |_| |_| |_| |_| |_| |_| |_| ',
        '|_| |_| |_| |_| |_| |_| |_| |_| |_| ',
        '                                    ',
        ' _   _   _   _   _   _   _   _   _  ',
        '|_| |_| |_| |_| |_| |_| |_| |_| |_| ',
        '|_| |_| |_| |_| |_| |_| |_| |_| |_| ',
        '                                    ',
      ])
    ).toEqual(['888888888 ERR', '888888888 ERR'])
  })

  it('parses_one_record_with_123456790', () => {
    expect(
      parse([
        '     _   _       _   _   _   _   _  ',
        '  |  _|  _| |_| |_  |_    | |_| | | ',
        '  | |_   _|   |  _| |_|   |  _| |_| ',
        '                                    ',
      ])
    ).toEqual(['123456790 ERR'])
  })

  it('parses_two_records', () => {
    expect(
      parse([
        '     _   _       _   _   _   _   _  ',
        '  |  _|  _| |_| |_  |_    | |_| | | ',
        '  | |_   _|   |  _| |_|   |  _| |_| ',
        '                                    ',
        ' _       _   _   _       _   _   _  ',
        '|_| |_|   | |_|   | |_|  _|  _|  _| ',
        ' _|   |   | |_|   |   | |_  |_  |_  ',
        '                                    ',
      ])
    ).toEqual(['123456790 ERR', '947874222 ERR'])
  })

  it('parses_illegal_digit', () => {
    expect(
      parse([
        '     _   _       _   _   _   _   _  ',
        '  |  _| |_|  _| |_  |_    | |_| | | ',
        '  | |_   _    |  _| |_|   |  _| |_| ',
        '                                    ',
      ])
    ).toEqual(['12??56790 ILL'])
  })

  it('checksum_fail_returns_ERR', () => {
    expect(
      parse([
        ' _   _       _   _           _   _  ',
        '|_  |_  |_|  _|   |   | |_| |_| |_  ',
        '|_| |_|   |  _|   |   |   |  _|  _| ',
        '                                    ',
      ])
    ).toEqual(['664371495 ERR'])
  })

  it('checksum_correct_returns_no_ERR', () => {
    expect(
      parse([
        ' _       _   _   _   _   _   _   _  ',
        ' _| |_| |_  |_| |_|  _| |_| |_  |_  ',
        ' _|   |  _| |_| |_| |_  |_| |_|  _| ',
        '                                    ',
      ])
    ).toEqual(['345882865    '])
  })
})
